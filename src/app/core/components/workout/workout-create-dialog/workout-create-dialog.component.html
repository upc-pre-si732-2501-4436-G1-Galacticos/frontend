<div class="dialog">
  <header class="dialog-header">
    <h2 class="dialog-title">
      {{ isEdit ? ('DIET_DIALOG.EDIT_TITLE' | translate) : ('DIET_DIALOG.CREATE_TITLE' | translate) }}
    </h2>
    <button class="close-btn" (click)="cancel()">×</button>
  </header>

  <form class="dialog-body" (ngSubmit)="confirm()">
    <!-- Título -->
    <div class="form-group">
      <label for="diet-title">{{ 'DIET_DIALOG.LABEL_TITLE' | translate }}</label>
      <input
        id="diet-title"
        type="text"
        name="title"
        [(ngModel)]="title"
        [placeholder]="'DIET_DIALOG.PLACEHOLDER_TITLE' | translate"
        required
      />
    </div>

    <!-- Nota -->
    <div class="form-group">
      <label for="diet-note">{{ 'DIET_DIALOG.LABEL_NOTE' | translate }}</label>
      <textarea
        id="diet-note"
        name="note"
        rows="3"
        [(ngModel)]="description"
        [placeholder]="'DIET_DIALOG.PLACEHOLDER_NOTE' | translate"
      ></textarea>
    </div>

    <ng-container *ngIf="!isEdit">
      <!-- Pestañas -->
      <nav class="tabs">
        <button
          type="button"
          [class.active]="selectedTabIndex === 0"
          (click)="onTabChanged(0)"
        >{{ 'DIET_DIALOG.TAB_MY_EXERCISES' | translate }}</button>

        <button
          type="button"
          [class.active]="selectedTabIndex === 1"
          (click)="onTabChanged(1)"
        >{{ 'DIET_DIALOG.TAB_COMMUNITY' | translate }}</button>
      </nav>

      <!-- Contenido -->
      <section class="tab-content">
        <div *ngIf="selectedTabIndex === 0" class="exercises-list">
          <button
            type="button"
            *ngFor="let m of exercisesMy"
            (click)="toggleExercise(m)"
            [class.selected]="selectedExercises.includes(m)"
          >
            {{ m.title }}
          </button>
        </div>

        <div *ngIf="selectedTabIndex === 1" class="exercises-list">
          <button
            type="button"
            *ngFor="let m of exercisesComm"
            (click)="toggleExercise(m)"
            [class.selected]="selectedExercises.includes(m)"
          >
            {{ m.title }}
          </button>
        </div>
      </section>

      <!-- Contador -->
      <div class="selection-count">
        {{ 'DIET_DIALOG.SELECTED_COUNT' | translate:{ count: selectedExercises.length } }}
      </div>
    </ng-container>

    <!-- Botones -->
    <footer class="dialog-actions">
      <button type="button" class="btn-secondary" (click)="cancel()">
        {{ 'COMMON2.CANCEL' | translate }}
      </button>

      <button
        type="submit"
        class="btn-primary"
        [disabled]="!isEdit && selectedExercises.length < 3"
      >
        {{ isEdit ? ('COMMON2.SAVE_CHANGES' | translate) : ('COMMON2.CONFIRM' | translate) }}
      </button>
    </footer>
  </form>
</div>
